domain = c(min(TEAMS$Rushing_YPA),max(TEAMS$Rushing_YPA)
)
)
)%>%
data_color(
columns = c(third_down_conv_rate),
colors = scales::col_numeric(
palette = c('red','white','green'),
domain = c(min(TEAMS$third_down_conv_rate),max(TEAMS$third_down_conv_rate)
)
)
) %>%
tab_header(
title = md("**Statistical Comparison**"),
subtitle = md("2022 Season")
) %>%
tab_footnote(
footnote = "YPG = Yards Per Game",
locations = cells_column_labels(
columns = c(Total_YPG, Passing_YPG, Rushing_YPG)
)
) %>%
tab_footnote(
footnote = "YPA = Yards Per Attempt",
locations = cells_column_labels(
columns = c(Passing_YPA, Rushing_YPA)
)
)  %>%
tab_footnote(
footnote = "YPC = Yards Per Completion",
locations = cells_column_labels(
columns = c(Passing_YPC)
)
)
library(gt)
knitr::opts_chunk$set(echo = TRUE)
library(rmarkdown)
library(dplyr)
library(readr)
library(cfbfastR)
#remotes::install_github(repo = "sportsdataverse/cfbfastR")
#remotes::install_github(repo = "Kazink36/cfbplotR",force = TRUE)
#library(cfbplotR)
Sys.setenv(CFBD_API_KEY = "x1C/67YV6Sy98uENGd+tSvJSr82NfDxHFTmWk4QB5wGl2qxogM53QKLB5T4l6kPn")
#Sys.setenv(CFBD_API_KEY = "OMFtwopAS5WexLsewwy5BKQsUIzguwFqGz6KkjiUc6zcpKNYphzld/71fWW7pt8j")
library(stringr)
library(tidyverse)
library(nnet)
library(mgcv)
library(texreg)
library(aod)
library(xtable)
library(xgboost)
library(readr)
library(stringr)
library(caret)
library(car)
library(tidyverse)
library(gt)
knitr::opts_chunk$set(echo = TRUE)
library(rmarkdown)
library(dplyr)
library(readr)
library(cfbfastR)
#remotes::install_github(repo = "sportsdataverse/cfbfastR")
#remotes::install_github(repo = "Kazink36/cfbplotR",force = TRUE)
#library(cfbplotR)
Sys.setenv(CFBD_API_KEY = "x1C/67YV6Sy98uENGd+tSvJSr82NfDxHFTmWk4QB5wGl2qxogM53QKLB5T4l6kPn")
#Sys.setenv(CFBD_API_KEY = "OMFtwopAS5WexLsewwy5BKQsUIzguwFqGz6KkjiUc6zcpKNYphzld/71fWW7pt8j")
library(stringr)
library(tidyverse)
library(nnet)
library(mgcv)
library(texreg)
library(aod)
library(xtable)
library(xgboost)
library(readr)
library(stringr)
library(caret)
library(car)
library(tidyverse)
library(gt)
week = 1
df = data.frame()
#conference = c('SEC')
fbs = cfbd_conferences()
fbs = subset(fbs, classification == 'fbs')
fbs = fbs[1:10,]
fbs_teams = load_cfb_teams()
fbs_teams = subset(fbs_teams, classification == 'fbs')
# team setup
# ht = cfbd_game_info(2022, week = week, conference = conference)$home_team[1]
# home_team_filter = ht = cfbd_game_info(2022, week = week, conference = conference)$home_team[1]
# at = cfbd_game_info(2022, week = week, conference = conference)$away_team[1]
ht=c('Tennessee')
at=c('Virginia')
# advanced stats by team
stats <- cfbd_stats_season_team(2022)
TEAMS <- cfbd_stats_season_advanced(2022)
TEAMS <- inner_join(stats,TEAMS,by = 'team')
TEAMS$Total_YPG <- TEAMS$total_yds / TEAMS$games
TEAMS$Passing_YPG <- TEAMS$net_pass_yds / TEAMS$games
TEAMS$Rushing_YPG <- TEAMS$rush_yds / TEAMS$games
TEAMS$Passing_YPA <- TEAMS$net_pass_yds / TEAMS$pass_atts
TEAMS$Passing_YPC <- TEAMS$net_pass_yds / TEAMS$pass_comps
TEAMS$Rushing_YPA <- TEAMS$rush_yds / TEAMS$rush_atts
TEAMS$third_down_conv_rate<- TEAMS$third_down_convs / TEAMS$third_downs
# Betting information
# Betting information
lines <- cfbd_betting_lines(year = 2023, week = 1, team = ht)
line <- subset(lines,provider == "DraftKings")
if (nrow(line) < 1){line <- subset(lines,provider == "Bovada")}
# bet$home_score <- ifelse(as.numeric(bet$spread) < 0, as.numeric(bet$over_under) + as.numeric(bet$spread),  as.numeric(bet$over_under) - as.numeric(bet$spread))
#
# bet$away_score <- as.numeric(bet$over_under) - as.numeric(bet$home_score)
bet <- data.frame(home_score=0,away_score=0,total=0,home_team=0,away_team=0,spread=0, home_conference=0)
bet$total <- as.numeric(line$over_under[1])
bet$spread <- as.numeric(line$spread[1])
bet$home_score <- ifelse(bet$spread  < 0, (bet$total/2)-(bet$spread/2), (bet$total/2)+(bet$spread/2))
bet$away_score <- bet$total - bet$home_score
bet$home_team <- ht
bet$away_team <- at
bet %>%
transmute(Game_Total = total,
Home_Team = home_team,
Home_Score = home_score, Away_Score= away_score,
Away_Team = away_team, Home_Spread = spread) %>%
gt() %>%
#gt_fmt_cfb_logo(columns = c(Conference)) %>%
gt_fmt_cfb_wordmark(columns = c(Home_Team,Away_Team)) %>%
cols_align(
align = c('center'),
columns = everything()
) %>%   cols_label(
Game_Total = md('**O/U**'),
Home_Team = md('**Home**'),
Home_Score = md('**Home Score**'),
Away_Score= md('**Away Score**'),
Away_Team = md('**Away**'),
Home_Spread = md('**Home Spread**')
) %>%
tab_header(
title = md("**Vegas Lines**"),
subtitle = md("Harrison Eller")
) %>%
fmt_number(
columns = c(Home_Score, Away_Score, Game_Total)
) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_body(
columns = c(Home_Score, Away_Score, Game_Total)
)
)
tab <- TEAMS %>%
filter(team %in% c(ht,at)) %>%
select(team, Total_YPG, Passing_YPG,Rushing_YPG, Passing_YPA, Passing_YPC, Rushing_YPA, pass_TDs, rush_TDs, passes_intercepted, off_success_rate, off_explosiveness,off_power_success,off_passing_plays_success_rate, off_passing_plays_explosiveness, off_rushing_plays_success_rate, off_rushing_plays_explosiveness)
#  offensive comparison
t <- TEAMS %>%
filter(team %in% c(ht,at))
t %>%
select(team, conference.x, pass_TDs, rush_TDs,  interceptions,fumbles_lost,Total_YPG, Passing_YPG,Rushing_YPG, Passing_YPA, Passing_YPC, Rushing_YPA, third_down_conv_rate,off_success_rate, off_explosiveness,off_power_success,off_passing_plays_success_rate, off_passing_plays_explosiveness, off_rushing_plays_success_rate, off_rushing_plays_explosiveness) %>%
transmute(Team = team, Passing_TDs = round(pass_TDs,0), Rushing_TDs = round(rush_TDs,0),  INTs = round(interceptions,0),FUM = round(fumbles_lost,0),Total_YPG, Passing_YPG,Rushing_YPG, Passing_YPA, Passing_YPC, Rushing_YPA, third_down_conv_rate) %>%
gt(rowname_col = c("Team")) %>%
gt_fmt_cfb_logo(columns = c(Team)) %>%
cols_label(
Team = md("**Team**"),
Passing_TDs = md("**Pass TDs**"),
Rushing_TDs = md("**Rush TDs**"),
INTs = md("**INT**"),
FUM = md("**FUM**"),
Total_YPG = md("**YPG**"),
Passing_YPG = md("**Pass YPG**"),
Rushing_YPG = md("**Rush YPG**"),
Passing_YPA = md("**Pass YPA**"),
Passing_YPC = md("**Pass YPC**"),
Rushing_YPA = md("**Rush YPA**"),
third_down_conv_rate = md("**3D Conversion Rate**")
) %>%
fmt_number(
columns = c(Passing_TDs,Rushing_TDs,INTs,FUM, Total_YPG, Passing_YPG,Rushing_YPG),
decimals = 0
) %>%
fmt_number(
columns = c(Passing_YPA, Passing_YPC, Rushing_YPA, third_down_conv_rate),
decimals = 2
) %>%
data_color(
columns = c(Passing_TDs),
colors = scales::col_numeric(
palette = c('red','white','green'),
domain = c(min(TEAMS$pass_TDs),max(TEAMS$pass_TDs)
)
)
) %>%
data_color(
columns = c(Rushing_TDs),
colors = scales::col_numeric(
palette = c('red','white','green'),
domain = c(min(TEAMS$rush_TDs),max(TEAMS$rush_TDs)
)
)
)  %>%
data_color(
columns = c(INTs),
colors = scales::col_numeric(
palette = c('green','white','red'),
domain = c(min(TEAMS$interceptions),max(TEAMS$interceptions)
)
)
) %>%
data_color(
columns = c(FUM),
colors = scales::col_numeric(
palette = c('green','white','red'),
domain = c(min(TEAMS$fumbles_lost),max(TEAMS$fumbles_lost)
)
)
) %>%
data_color(
columns = c(Total_YPG),
colors = scales::col_numeric(
palette = c('red','white','green'),
domain = c(min(TEAMS$Total_YPG),max(TEAMS$Total_YPG)
)
)
)  %>%
data_color(
columns = c(Passing_YPG),
colors = scales::col_numeric(
palette = c('red','white','green'),
domain = c(min(TEAMS$Passing_YPG),max(TEAMS$Passing_YPG)
)
)
) %>%
data_color(
columns = c(Rushing_YPG),
colors = scales::col_numeric(
palette = c('red','white','green'),
domain = c(min(TEAMS$Rushing_YPG),max(TEAMS$Rushing_YPG)
)
)
)%>%
data_color(
columns = c(Passing_YPA),
colors = scales::col_numeric(
palette = c('red','white','green'),
domain = c(min(TEAMS$Passing_YPA),max(TEAMS$Passing_YPA)
)
)
)%>%
data_color(
columns = c(Passing_YPC	),
colors = scales::col_numeric(
palette = c('red','white','green'),
domain = c(min(TEAMS$Passing_YPC),max(TEAMS$Passing_YPC)
)
)
)%>%
data_color(
columns = c(Rushing_YPA	),
colors = scales::col_numeric(
palette = c('red','white','green'),
domain = c(min(TEAMS$Rushing_YPA),max(TEAMS$Rushing_YPA)
)
)
)%>%
data_color(
columns = c(third_down_conv_rate),
colors = scales::col_numeric(
palette = c('red','white','green'),
domain = c(min(TEAMS$third_down_conv_rate),max(TEAMS$third_down_conv_rate)
)
)
) %>%
tab_header(
title = md("**Statistical Comparison**"),
subtitle = md("2022 Season")
) %>%
tab_footnote(
footnote = "YPG = Yards Per Game",
locations = cells_column_labels(
columns = c(Total_YPG, Passing_YPG, Rushing_YPG)
)
) %>%
tab_footnote(
footnote = "YPA = Yards Per Attempt",
locations = cells_column_labels(
columns = c(Passing_YPA, Rushing_YPA)
)
)  %>%
tab_footnote(
footnote = "YPC = Yards Per Completion",
locations = cells_column_labels(
columns = c(Passing_YPC)
)
)
#remotes::install_github(repo = "sportsdataverse/cfbfastR")
remotes::install_github(repo = "Kazink36/cfbplotR",force = TRUE)
#remotes::install_github(repo = "sportsdataverse/cfbfastR")
remotes::install_github(repo = "Kazink36/cfbplotR",force = TRUE)
install.packages('Rtools')
setwd("C:/Users/Harrison Eller/CFB_Analytics")
team_plot_data = read.csv('tpd.csv')
library(cfbplotR)
#remotes::install_github(repo = "sportsdataverse/cfbfastR")
remotes::install_github(repo = "sportsdataverse/cfbplotR")
library(cfbplotR)
team_plot_data$conference = 0
for(i in 1:nrow(team_plot_data)){
team_plot_data$conference[i] = cfbd_stats_season_team(year = 2022, team = team_plot_data$ht[i])$conference
}
library(cfbfastR)
library(stringr)
library(tidyverse)
library(nnet)
library(mgcv)
library(texreg)
library(aod)
library(xtable)
library(xgboost)
library(readr)
library(stringr)
library(caret)
library(car)
library(tidyverse)
library(gt)
team_plot_data$conference = 0
for(i in 1:nrow(team_plot_data)){
team_plot_data$conference[i] = cfbd_stats_season_team(year = 2022, team = team_plot_data$ht[i])$conference
}
Sys.setenv(CFBD_API_KEY = "x1C/67YV6Sy98uENGd+tSvJSr82NfDxHFTmWk4QB5wGl2qxogM53QKLB5T4l6kPn")
team_plot_data$conference = 0
for(i in 1:nrow(team_plot_data)){
team_plot_data$conference[i] = cfbd_stats_season_team(year = 2022, team = team_plot_data$ht[i])$conference
}
team_plot_data %>%
transmute(Conference = conference, Home_Team = ht,
Home_Score = round(ht_score,2),
Away_Score = round(at_score,2), Away_Team = at, Spread_Pick = value_side) %>%
arrange(desc(Conference)) %>%
gt() %>%
gt_fmt_cfb_logo(columns = c(Conference, Spread_Pick)) %>%
gt_fmt_cfb_wordmark(columns = c(Home_Team,Away_Team)) %>%
cols_align(
align = c('center'),
columns = everything()
) %>%
tab_header(
title = md("**Scarlett Score Predictions**"),
subtitle = md("Harrison Eller")
) %>%
fmt_number(
columns = c(Home_Score, Away_Score)
) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_body(
columns = c(Home_Score, Away_Score)
)
)
team_plot_data %>%
transmute(Conference = conference, Home_Team = ht,
Home_Score = round(ht_score,2),
Away_Score = round(at_score,2), Away_Team = at, Spread_Pick = value_side) %>%
arrange(desc(Conference)) %>%
gt() %>%
gt_fmt_cfb_logo(columns = c("Conference", "Spread_Pick")) %>%
gt_fmt_cfb_wordmark(columns = c("Home_Team","Away_Team")) %>%
cols_align(
align = c('center'),
columns = everything()
) %>%
tab_header(
title = md("**Scarlett Score Predictions**"),
subtitle = md("Harrison Eller")
) %>%
fmt_number(
columns = c("Home_Score", "Away_Score")
) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_body(
columns = c("Home_Score", "Away_Score")
)
)
y
team_plot_data
team_plot_data$ht_score[2]
team_plot_data$ht_score[3]
team_plot_data$ht_score[3]=42.2
team_plot_data$value_side[3] = "Vanderbilt"
team_plot_data$ht_score[2]=16.8
team_plot_data$value_side[2] = "Ohio"
team_plot_data %>%
transmute(Conference = conference, Home_Team = ht,
Home_Score = round(ht_score,2),
Away_Score = round(at_score,2), Away_Team = at, Spread_Pick = value_side) %>%
arrange(desc(Conference)) %>%
gt() %>%
gt_fmt_cfb_logo(columns = c("Conference", "Spread_Pick")) %>%
gt_fmt_cfb_wordmark(columns = c("Home_Team","Away_Team")) %>%
cols_align(
align = c('center'),
columns = everything()
) %>%
tab_header(
title = md("**Scarlett Score Predictions**"),
subtitle = md("Harrison Eller")
) %>%
fmt_number(
columns = c("Home_Score", "Away_Score")
) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_body(
columns = c("Home_Score", "Away_Score")
)
)
team_plot_data$value_side[4] = "Louisiana Tech"
team_plot_data %>%
transmute(Conference = conference, Home_Team = ht,
Home_Score = round(ht_score,2),
Away_Score = round(at_score,2), Away_Team = at, Spread_Pick = value_side) %>%
arrange(desc(Conference)) %>%
gt() %>%
gt_fmt_cfb_logo(columns = c("Conference", "Spread_Pick")) %>%
gt_fmt_cfb_wordmark(columns = c("Home_Team","Away_Team")) %>%
cols_align(
align = c('center'),
columns = everything()
) %>%
tab_header(
title = md("**Scarlett Score Predictions**"),
subtitle = md("Harrison Eller")
) %>%
fmt_number(
columns = c("Home_Score", "Away_Score")
) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_body(
columns = c("Home_Score", "Away_Score")
)
)
team_plot_data$at_score[2]=16.8
team_plot_data %>%
transmute(Conference = conference, Home_Team = ht,
Home_Score = round(ht_score,2),
Away_Score = round(at_score,2), Away_Team = at, Spread_Pick = value_side) %>%
arrange(desc(Conference)) %>%
gt() %>%
gt_fmt_cfb_logo(columns = c("Conference", "Spread_Pick")) %>%
gt_fmt_cfb_wordmark(columns = c("Home_Team","Away_Team")) %>%
cols_align(
align = c('center'),
columns = everything()
) %>%
tab_header(
title = md("**Scarlett Score Predictions**"),
subtitle = md("Harrison Eller")
) %>%
fmt_number(
columns = c("Home_Score", "Away_Score")
) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_body(
columns = c("Home_Score", "Away_Score")
)
)
team_plot_data$at_score[2]=16.2
team_plot_data %>%
transmute(Conference = conference, Home_Team = ht,
Home_Score = round(ht_score,2),
Away_Score = round(at_score,2), Away_Team = at, Spread_Pick = value_side) %>%
arrange(desc(Conference)) %>%
gt() %>%
gt_fmt_cfb_logo(columns = c("Conference", "Spread_Pick")) %>%
gt_fmt_cfb_wordmark(columns = c("Home_Team","Away_Team")) %>%
cols_align(
align = c('center'),
columns = everything()
) %>%
tab_header(
title = md("**Scarlett Score Predictions**"),
subtitle = md("Harrison Eller")
) %>%
fmt_number(
columns = c("Home_Score", "Away_Score")
) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_body(
columns = c("Home_Score", "Away_Score")
)
)
